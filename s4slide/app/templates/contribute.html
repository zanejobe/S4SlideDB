<!DOCTYPE html>
<html lang="en">

	{% include "head.html" with title="Contribute" %}

	<body>
		<h1 id="title">Website Contributors</h1>

		{% include "navbar.html" %}

		<div id="content">
			<div id="left">
				<div id="inner-left" class="box">
					<p>Thank you for showing interest in contributing to the S4Slide Database.
					If you wish to upload data, you must be signed in with Google.</p>
					<p>In order to facilitate data storage, file uploads must be in a consistent format.
					A sample CSV file with the required column headers
					{% load static %}
					<a href="{% static "s4slide-db-template.csv" %}" download>can be downloaded here</a>.
					Please fill them in to the best of your ability. Further details on the schema
					<a href="https://github.com/zanejobe/S4SlideDB/blob/master/schema/schema.csv">
						can be found here</a>.</p>
				</div>

			</div>

			<div id="right">
				<script src="https://apis.google.com/js/platform.js" async defer></script>
				<div id="inner-right" class="box">
					<div class="g-signin2" data-onsuccess="onSignIn"></div>
					<p style="color:red">Navigating away from this page, reloading the page, or closing the page will sign you out.</p>
				</div>
				<script>
function onSignIn(googleUser) {
	if (!googleUser) return;
	var profile = googleUser.getBasicProfile();
	sessionStorage.setItem("id", profile.getId());
	sessionStorage.setItem("name", profile.getName());
	sessionStorage.setItem("email", profile.getEmail());
	var input = document.createElement("input");
	input.type = "file";
	input.accept = ".csv,text/csv";
	input.required = true;
	var form = document.getElementById("ul-form");
	form.insertBefore(input, form.childNodes[0]);
	document.getElementById("ul").style.display = "block";
}

function signOut() {
	gapi.auth2.getAuthInstance().signOut().then(function () {
		sessionStorage.clear();
	});
}

window.addEventListener("beforeunload", function (ev) { signOut(); });
				</script>
				<div id="ul" class="box" style="display:none">
					<form id="ul-form">
						<button type="submit">Submit</button>
					</form>
					<p style="color:red">By clicking submit, you agree to have your name and email associated with the file upload.</p>
				</div>
			</div>

		</div>

		<footer id="footer">
		</footer>

	</body>
</html>
